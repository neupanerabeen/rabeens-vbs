{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport MapperRegistry from \"./MapperRegistry\";\nimport MutableValue from \"./MutableValue\";\nimport Mapper from \"./Mapper\";\n\nvar JSReanimated = function () {\n  function JSReanimated() {\n    _classCallCheck(this, JSReanimated);\n\n    this.native = false;\n    this._valueSetter = undefined;\n    this._renderRequested = false;\n    this._mapperRegistry = new MapperRegistry(this);\n    this._frames = [];\n    this.timeProvider = {};\n\n    if (process.env.JEST_WORKER_ID) {\n      this.timeProvider.now = function () {\n        return Date.now();\n      };\n    } else {\n      this.timeProvider.now = function () {\n        return window.performance.now();\n      };\n    }\n  }\n\n  _createClass(JSReanimated, [{\n    key: \"pushFrame\",\n    value: function pushFrame(frame) {\n      this._frames.push(frame);\n\n      this.maybeRequestRender();\n    }\n  }, {\n    key: \"getTimestamp\",\n    value: function getTimestamp() {\n      return this.timeProvider.now();\n    }\n  }, {\n    key: \"maybeRequestRender\",\n    value: function maybeRequestRender() {\n      var _this = this;\n\n      if (!this._renderRequested) {\n        this._renderRequested = true;\n        requestAnimationFrame(function (_timestampMs) {\n          _this._renderRequested = false;\n\n          _this._onRender(_this.getTimestamp());\n        });\n      }\n    }\n  }, {\n    key: \"_onRender\",\n    value: function _onRender(timestampMs) {\n      this._mapperRegistry.execute();\n\n      var frames = _toConsumableArray(this._frames);\n\n      this._frames = [];\n\n      for (var i = 0, len = frames.length; i < len; ++i) {\n        frames[i](timestampMs);\n      }\n\n      if (this._mapperRegistry.needRunOnRender) {\n        this._mapperRegistry.execute();\n      }\n    }\n  }, {\n    key: \"installCoreFunctions\",\n    value: function installCoreFunctions(valueSetter) {\n      this._valueSetter = valueSetter;\n    }\n  }, {\n    key: \"makeShareable\",\n    value: function makeShareable(value) {\n      return value;\n    }\n  }, {\n    key: \"makeMutable\",\n    value: function makeMutable(value) {\n      return new MutableValue(value, this._valueSetter);\n    }\n  }, {\n    key: \"makeRemote\",\n    value: function makeRemote(object) {\n      return object;\n    }\n  }, {\n    key: \"startMapper\",\n    value: function startMapper(mapper) {\n      var inputs = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n      var outputs = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n      var instance = new Mapper(this, mapper, inputs, outputs);\n\n      var mapperId = this._mapperRegistry.startMapper(instance);\n\n      this.maybeRequestRender();\n      return mapperId;\n    }\n  }, {\n    key: \"stopMapper\",\n    value: function stopMapper(mapperId) {\n      this._mapperRegistry.stopMapper(mapperId);\n    }\n  }, {\n    key: \"registerEventHandler\",\n    value: function registerEventHandler(_eventHash, _eventHandler) {}\n  }, {\n    key: \"unregisterEventHandler\",\n    value: function unregisterEventHandler(_registrationId) {}\n  }]);\n\n  return JSReanimated;\n}();\n\nexport { JSReanimated as default };","map":null,"metadata":{},"sourceType":"module"}